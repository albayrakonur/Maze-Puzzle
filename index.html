<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maze Puzzle</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/themes/jquery.ui.all.css" />

    <script src="./js/jquery-1.7.2.min.js" type="text/javascript"></script>

    <script type="text/javascript" src="./js/ui/jquery.ui.core.min.js"></script>
    <script type="text/javascript" src="./js//ui/jquery.ui.widget.min.js"></script>
    <script type="text/javascript" src="./js//ui/jquery.ui.mouse.min.js"></script>
    <script type="text/javascript" src="./js//ui/jquery.ui.draggable.min.js"></script>
    <script type="text/javascript" src="./js//ui/jquery.ui.accordion.min.js"></script>
    <script type="text/javascript" src="./js//ui/jquery.ui.slider.min.js"></script>

</head>

<body>
    <div id="instructions_panel" class="panel">
        <header>
            <h2 class="header_title">Instructions</h2>
            <span id="hide_instructions">hide</span>
        </header>
        Click within the <span class="white">white</span> grid and drag your mouse to draw obstacles. <br>
        Click the <span class="green">green</span> node to set the start position random. <br>
        Click the <span class="red">red</span> node to set the end position random. <br>
        Choose an algorithm from the right-hand panel. <br>
        Click Start Search in the lower-right corner to start the animation.
    </div>
    <div id="algorithm_panel" class="panel right_panel">
        <header>
            <h2 class="header_title">Settings</h2>
        </header>

        <div class="accordion">
            <h3 id="astar_header"><a href="#">A*</a></h3>
            <div id="astar_section" class="finder_section">
                <header class="option_header">
                    <h3>Heuristic</h3>
                </header>
                <div id="astar_heuristic" class="sub_options">
                    <input type="radio" name="astar_heuristic" value="manhattan" checked />
                    <label class="option_label">Manhattan</label> <br>
                    <input type="radio" name="astar_heuristic" value="euclidean" />
                    <label class="option_label">Euclidean</label> <br>
                    <input type="radio" name="astar_heuristic" value="octile" />
                    <label class="option_label">Octile</label> <br>
                    <input type="radio" name="astar_heuristic" value="chebyshev" />
                    <label class="option_label">Chebyshev</label> <br>
                </div>

                <header class="option_header">
                    <h3>Options</h3>
                </header>
                <div class="optional sub_options">
                    <input type="checkbox" class="allow_diagonal" checked>
                    <label class="option_label">Allow Diagonal</label> <br>
                    <input type="checkbox" class="bi-directional">
                    <label class="option_label">Bi-directional</label> <br>
                    <input type="checkbox" class="dont_cross_corners">
                    <label class="option_label">Don't Cross Corners</label> <br>
                    <input class="spinner" name="astar_weight" value="1">
                    <label class="option_label">Weight</label> <br>
                </div>
            </div>

            <h3 id="ida_header"><a href="#">IDA*</a></h3>
            <div id="ida_section" class="finder_section">
                <header class="option_header">
                    <h3>Heuristic</h3>
                </header>
                <div id="ida_heuristic" class="sub_options">
                    <input type="radio" name="ida_heuristic" value="manhattan" checked />
                    <label class="option_label">Manhattan</label> <br>
                    <input type="radio" name="ida_heuristic" value="euclidean" />
                    <label class="option_label">Euclidean</label> <br>
                    <input type="radio" name="ida_heuristic" value="octile" />
                    <label class="option_label">Octile</label> <br>
                    <input type="radio" name="ida_heuristic" value="chebyshev" />
                    <label class="option_label">Chebyshev</label> <br>
                </div>
                <header class="option_header">
                    <h3>Options</h3>
                </header>
                <div class="optional sub_options">
                    <input type="checkbox" class="allow_diagonal" checked>
                    <label class="option_label">Allow Diagonal</label> <br>
                    <input type="checkbox" class="dont_cross_corners">
                    <label class="option_label">Don't Cross Corners</label> <br>
                    <input class="spinner" name="astar_weight" value="1">
                    <label class="option_label">Weight</label> <br>
                    <input class="spinner" name="time_limit" value="10">
                    <label class="option_label">Seconds limit</label> <br>
                    <input type="checkbox" class="track_recursion" checked />
                    <label class="option_label">Visualize recursion</label> <br>
                </div>
            </div>

            <h3 id="breadthfirst_header"><a href="#">Breadth-First-Search</a></h3>
            <div id="breadthfirst_section" class="finder_section">
                <header class="option_header">
                    <h3>Options</h3>
                </header>
                <div class="optional sub_options">
                    <input type="checkbox" class="allow_diagonal" checked>
                    <label class="option_label">Allow Diagonal</label> <br>
                    <input type="checkbox" class="bi-directional">
                    <label class="option_label">Bi-directional</label> <br>
                    <input type="checkbox" class="dont_cross_corners">
                    <label class="option_label">Don't Cross Corners</label> <br>
                </div>
            </div>

            <h3 id="bestfirst_header"><a href="#">Best-First-Search</a></h3>
            <div id="bestfirst_section" class="finder_section">
                <header class="option_header">
                    <h3>Heuristic</h3>
                </header>
                <div id="bestfirst_heuristic" class="sub_options">
                    <input type="radio" name="bestfirst_heuristic" value="manhattan" checked />
                    <label class="option_label">Manhattan</label> <br>
                    <input type="radio" name="bestfirst_heuristic" value="euclidean" />
                    <label class="option_label">Euclidean</label> <br>
                    <input type="radio" name="bestfirst_heuristic" value="octile" />
                    <label class="option_label">Octile</label> <br>
                    <input type="radio" name="bestfirst_heuristic" value="chebyshev" />
                    <label class="option_label">Chebyshev</label> <br>
                </div>

                <header class="option_header">
                    <h3>Options</h3>
                </header>
                <div class="optional sub_options">
                    <input type="checkbox" class="allow_diagonal" checked>
                    <label class="option_label">Allow Diagonal</label> <br>
                    <input type="checkbox" class="bi-directional">
                    <label class="option_label">Bi-directional</label> <br>
                    <input type="checkbox" class="dont_cross_corners">
                    <label class="option_label">Don't Cross Corners</label> <br>
                </div>
            </div>

            <h3 id="dijkstra_header"><a href="#">Dijkstra</a></h3>
            <div id="dijkstra_section" class="finder_section">
                <header class="option_header">
                    <h3>Options</h3>
                </header>
                <div class="optional sub_options">
                    <input type="checkbox" class="allow_diagonal" checked>
                    <label class="option_label">Allow Diagonal</label> <br>
                    <input type="checkbox" class="bi-directional">
                    <label class="option_label">Bi-directional</label> <br>
                    <input type="checkbox" class="dont_cross_corners">
                    <label class="option_label">Don't Cross Corners</label> <br>
                </div>
            </div>

            <h3 id="jump_point_header"><a href="#">Jump Point Search</a></h3>
            <div id="jump_point_section" class="finder_section">
                <header class="option_header">
                    <h3>Heuristic</h3>
                </header>
                <div id="jump_point_heuristic" class="sub_options">
                    <input type="radio" name="jump_point_heuristic" value="manhattan" checked />
                    <label class="option_label">Manhattan</label> <br>
                    <input type="radio" name="jump_point_heuristic" value="euclidean" />
                    <label class="option_label">Euclidean</label> <br>
                    <input type="radio" name="jump_point_heuristic" value="octile" />
                    <label class="option_label">Octile</label> <br>
                    <input type="radio" name="jump_point_heuristic" value="chebyshev" />
                    <label class="option_label">Chebyshev</label> <br>
                </div>
                <header class="option_header">
                    <h3>Options</h3>
                </header>
                <div class="optional sub_options">
                    <input type="checkbox" class="track_recursion" checked>
                    <label class="option_label">Visualize recursion</label> <br>
                </div>
            </div>

            <h3 id="orth_jump_point_header"><a href="#">Orthogonal Jump Point Search</a></h3>
            <div id="orth_jump_point_section" class="finder_section">
                <header class="option_header">
                    <h3>Heuristic</h3>
                </header>
                <div id="orth_jump_point_heuristic" class="sub_options">
                    <input type="radio" name="orth_jump_point_heuristic" value="manhattan" checked />
                    <label class="option_label">Manhattan</label> <br>
                    <input type="radio" name="orth_jump_point_heuristic" value="euclidean" />
                    <label class="option_label">Euclidean</label> <br>
                    <input type="radio" name="orth_jump_point_heuristic" value="octile" />
                    <label class="option_label">Octile</label> <br>
                    <input type="radio" name="orth_jump_point_heuristic" value="chebyshev" />
                    <label class="option_label">Chebyshev</label> <br>
                </div>
                <header class="option_header">
                    <h3>Options</h3>
                </header>
                <div class="optional sub_options">
                    <input type="checkbox" class="track_recursion" checked>
                    <label class="option_label">Visualize recursion</label> <br>
                </div>
            </div>
        </div><!-- .accordion -->
        <br>
        <hr>
        <label for="frequency">Obstacles Frequency</label>
        <select name="frequency" id="frequency">
            <option value=10 selected="selected">10%</option>
            <option value=20>%20</option>
            <option value=30>%30</option>
            <option value=40>%40</option>
            <option value=50>%50</option>
        </select>

    </div><!-- #algorithm_panel -->
    <div class="wrapper" id="outer">
    </div>
</body>

<script>
    var obstaclesPositions = []
    var maxSize = 0

    $(document).ready(() => {
        $('.panel').draggable();
        $('.accordion').accordion({
            collapsible: true,
        });

        $('#hide_instructions').click(function () {
            $('#instructions_panel').slideUp();
        });
        const rows = 32
        const cols = 64
        const outer = $('#outer')
        maxSize = rows * cols
        let size = 0;

        for (let i = 0; i < rows; i++) {
            const row = $('<div>', { class: 'row' })
            for (let j = 0; j < cols; j++) {
                row.append($('<div>', { class: 'column', id: size++ }).click(handleClick))
            }
            outer.append(row)
        }

        const hunter = $('#' + getRndInteger(0, maxSize))
        hunter.addClass('hunter')
        const hunt = $('#' + getRndInteger(0, maxSize))
        hunt.addClass('hunt')
        //console.log(typeof parseInt($('#frequency :selected').val()))

        putObstacles()

        $("#frequency").change(function () {
            putObstacles()
        });

    })

    function handleClick(event) {
        //if (event.buttons == 1) {
        const target = $(event.currentTarget)

        if (target.hasClass('obstacle')) {
            target.removeClass('obstacle')
        } else if (target.hasClass('hunt') || target.hasClass('hunter')) {
            let rnd = getRndInteger(0, maxSize)
            while (isEmpty(rnd) != 1) {
                rnd = getRndInteger(0, maxSize)
            }
            if (target.hasClass('hunt')) {
                target.removeClass('hunt')
                $('#' + rnd).addClass('hunt')
            } else if (target.hasClass('hunter')) {
                target.removeClass('hunter')
                $('#' + rnd).addClass('hunter')
            }
        } else {
            target.addClass('obstacle')
        }
        //console.log(target.attr('id'))
        //}
    }

    function isEmpty(pos) {
        if (!$('#' + pos).hasClass('obstacle') && !$('#' + pos).hasClass('hunt') && !$('#' + pos).hasClass('hunter')) {
            return 1
        } else {
            return 0
        }
    }

    function putObstacles() {
        if (obstaclesPositions.length != 0) {
            for (let i = 0; i < obstaclesPositions.length; i++) {
                $('#' + obstaclesPositions[i]).removeClass('obstacle')
            }
        }
        let freq = parseInt(maxSize * parseFloat($('#frequency :selected').val() / 100))
        while (freq != 0) {
            let rnd = getRndInteger(0, maxSize)
            if (isEmpty(rnd) == 1) {
                $('#' + rnd).addClass('obstacle')
                obstaclesPositions.push(rnd)
                //console.log(obstaclesPositions)
                freq -= 1
            }
        }
    }

    function getRndInteger(min, max) {
        return Math.floor(Math.random() * (max - min)) + min;
    }
</script>

</html>